<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Librarian Portal ‚Äî Bataan Heroes College</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    /* Reset and Base Styles */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      height: 100%;
      font-family: 'Inter', sans-serif;
      overflow-x: hidden;
    }
    body { transition: opacity 0.5s ease; }

    /* Animated Background */
    .background {
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      background: linear-gradient(135deg,#0f0f23,#1a1a2e 25%,#16213e 50%,#1a1a2e 75%,#0f0f23);
      z-index: -1; overflow: hidden;
    }
    .gradient-orb {
      position: absolute; border-radius: 50%; filter: blur(60px); opacity: 0.7;
      animation: float 8s ease-in-out infinite;
    }
    .orb-1 { width: 400px; height: 400px; background: radial-gradient(circle,rgba(220,38,38,.4),transparent); top:-200px; left:-200px; }
    .orb-2 { width: 300px; height: 300px; background: radial-gradient(circle,rgba(59,130,246,.3),transparent); bottom:-150px; right:-150px; animation-delay:-4s; }
    .orb-3 { width: 250px; height: 250px; background: radial-gradient(circle,rgba(168,85,247,.3),transparent); top:50%; left:50%; transform:translate(-50%,-50%); animation-delay:-2s; }
    @keyframes float {
      0%,100%{ transform:translate(0,0) scale(1);}
      25%{ transform:translate(30px,-30px) scale(1.1);}
      50%{ transform:translate(-20px,20px) scale(.9);}
      75%{ transform:translate(20px,30px) scale(1.05);}
    }

    /* Particles */
    .particles{ position:absolute; width:100%; height:100%; }
    .particle{ position:absolute; border-radius:50%; background:rgba(255,255,255,.5); animation:particleFloat 15s linear infinite; }
    @keyframes particleFloat {
      0%{ transform:translateY(100vh); opacity:0;}
      10%,90%{ opacity:1;}
      100%{ transform:translateY(-100px) translateX(100px); opacity:0;}
    }

    /* Container */
    .container { min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:2rem; z-index:1; }

    /* Card */
    .login-card {
      max-width:420px; width:100%; background:rgba(255,255,255,.95);
      border-radius:24px; overflow:hidden; border:1px solid rgba(255,255,255,.2);
      box-shadow:0 32px 64px rgba(0,0,0,.4);
      animation:cardEntrance .8s cubic-bezier(.34,1.56,.64,1);
    }
    @keyframes cardEntrance { from{opacity:0;transform:scale(.8) translateY(40px);} to{opacity:1;transform:scale(1) translateY(0);} }

    .card-header {
      background:linear-gradient(135deg,#0f0f23,#1a1a2e 50%,#16213e);
      padding:2.5rem 2rem 2rem; text-align:center; color:#fff; position:relative;
    }
    .logo { width:80px;height:80px; border-radius:20px; display:flex; justify-content:center;align-items:center; margin:0 auto 1rem; background:rgba(255,255,255,.1);}
    .title { font-size:1.75rem; font-weight:700; }
    .subtitle { font-size:.875rem; opacity:.9; }
    .tagline { font-size:.75rem; opacity:.7; }

    .card-body { padding:2rem; background:#fff; }
    .form-group { margin-bottom:1.5rem; }
    .form-label { font-size:.875rem; font-weight:600; margin-bottom:.5rem; display:block; }
    .form-input {
      width:100%; padding:.75rem 1rem .75rem 2.75rem;
      border:2px solid #e5e7eb; border-radius:12px; font-size:.875rem;
    }
    .form-input:focus { border-color:#dc2626; outline:none; box-shadow:0 0 0 3px rgba(220,38,38,.1); }

    .input-container { position:relative; }
    .input-icon { position:absolute; left:1rem; top:50%; transform:translateY(-50%); color:#6b7280; }

    .password-toggle { position:absolute; right:1rem; top:50%; transform:translateY(-50%); background:none; border:none; cursor:pointer; color:#6b7280; }

    .error-message { color:#dc2626; font-size:.75rem; margin-top:.25rem; min-height: 1.2em; opacity:0; transition:.3s; }
    .error-message.show { opacity:1; }

    .forgot-password { text-align:right; margin-bottom:1rem; }
    .forgot-link { background:none; border:none; color:#3b82f6; cursor:pointer; font-size:.75rem; }

    .submit-btn {
      width:100%; padding:.75rem; border:none; border-radius:12px;
      background:linear-gradient(135deg,#dc2626,#ef4444); color:white; font-weight:600; cursor:pointer;
      transition:.3s; position:relative; overflow:hidden;
    }
    .submit-btn:hover { transform:scale(1.02); }
    .submit-btn:disabled { background: #9ca3af; cursor: not-allowed; }


    .footer { margin-top:1.5rem; text-align:center; color:#fff; font-size:.75rem; }
    .footer-tagline { font-size:.7rem; opacity:.7; }

    /* Toggle link styling */
    .toggle-link { margin-top:1rem; text-align:center; font-size:.85rem; }
    .toggle-link a {
        color:#3b82f6;
        font-weight: 500;
        cursor: pointer;
        text-decoration: none;
    }
    .toggle-link a:hover { text-decoration: underline; }

    /* Modal */
    .modal-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.6); justify-content:center; align-items:center; z-index:1000; }
    .modal-overlay.show { display:flex; }
    .modal { background:#fff; border-radius:16px; padding:2rem; max-width:350px; text-align:center; }
    .modal-title { font-size:1.25rem; margin:.5rem 0; }
    .modal-message { font-size:.9rem; margin-bottom:1rem; }
    .modal-btn { padding:.5rem 1rem; border:none; border-radius:8px; background:#dc2626; color:#fff; cursor:pointer; }
  </style>
</head>
<body>
  <!-- Background -->
  <div class="background">
    <div class="gradient-orb orb-1"></div>
    <div class="gradient-orb orb-2"></div>
    <div class="gradient-orb orb-3"></div>
    <div class="particles" id="particles"></div>
  </div>

  <!-- Main -->
  <div class="container">
    <div class="login-card" id="loginCard">
      <div class="card-header">
        <div class="logo">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
          </svg>
        </div>
        <p class="subtitle">Bataan Heroes College Library System</p>
      </div>

      <!-- Sign In Form -->
      <div class="card-body" id="signInForm">
        <form>
          <div class="form-group">
            <label class="form-label">Email Address</label>
            <div class="input-container">
              <div class="input-icon">üìß</div>
              <input type="email" id="email" class="form-input" placeholder="librarian@gmail.com" required>
            </div>
            <div class="error-message" id="emailError"></div>
          </div>
          <div class="form-group">
            <label class="form-label">Password</label>
            <div class="input-container">
              <div class="input-icon">üîí</div>
              <input type="password" id="password" class="form-input" placeholder="Enter password" required minlength="8">
              <button type="button" class="password-toggle" id="passwordToggle">üëÅ</button>
            </div>
            <div class="error-message" id="passwordError"></div>
          </div>
          <div class="forgot-password">
            <button type="button" id="forgotPassword" class="forgot-link">Forgot your password?</button>
          </div>
          <button type="submit" class="submit-btn" id="submitBtn">Sign In</button>
        </form>
        <div class="toggle-link">
          <span>Don't have an account? </span>
          <a href="register.html">Create Account</a>
        </div>
      </div>
    </div>

    <div class="footer">
      <div>¬© 2025 Bataan Heroes College Library Management System</div>
      <div class="footer-tagline">Secure ‚Ä¢ Professional ‚Ä¢ Reliable</div>
    </div>
  </div>

  <!-- Success Modal -->
  <div class="modal-overlay" id="successModal">
    <div class="modal">
      <h3 class="modal-title">Authentication Successful!</h3>
      <p class="modal-message">Welcome to the Library Management System</p>
      <button class="modal-btn" id="modalClose">Continue</button>
    </div>
  </div>

  <!-- =============================================================================== -->
  <!-- START OF JAVASCRIPT: THE ONLY SECTION THAT HAS BEEN CHANGED -->
  <!-- =============================================================================== -->
  <script>
    // Particle system (Your original code, unchanged)
    class ParticleSystem {
      constructor(){ this.container=document.getElementById('particles'); for(let i=0;i<40;i++) this.createParticle(); }
      createParticle(){
        const p=document.createElement('div');
        p.className='particle';
        const size=Math.random()*3+1;
        p.style.width=p.style.height=size+'px';
        p.style.left=Math.random()*window.innerWidth+'px';
        p.style.top=Math.random()*window.innerHeight+'px';
        p.style.opacity=Math.random()*.5+.2;
        this.container.appendChild(p);
      }
    }

    // Form handler (UPDATED with server connection logic)
    class FormHandler {
      constructor(){
        this.form = document.querySelector('#signInForm form');
        this.submitBtn = document.getElementById('submitBtn');
        this.email = document.getElementById('email');
        this.password = document.getElementById('password');
        this.emailError = document.getElementById('emailError');
        this.passwordError = document.getElementById('passwordError');
        this.toggle = document.getElementById('passwordToggle');
        this.modal = document.getElementById('successModal');
        this.modalClose = document.getElementById('modalClose');
        this.init();
      }

      init(){
        this.form.addEventListener('submit', e => this.handleSubmit(e));
        this.toggle.addEventListener('click', () => this.togglePassword());
        this.modalClose.addEventListener('click', () => {
            this.modal.classList.remove('show');
            // After successful login, redirect to the main library page
            window.location.href = "home.html"; // <-- CHANGE THIS to your dashboard/main page
        });
      }

      togglePassword(){
        this.password.type = this.password.type === 'password' ? 'text' : 'password';
      }

      validate(){
        let valid = true;
        // Clear previous errors
        this.emailError.classList.remove('show');
        this.passwordError.classList.remove('show');
        this.emailError.textContent = '';
        this.passwordError.textContent = '';


        if (!/^\S+@\S+\.\S+$/.test(this.email.value)) {
            this.emailError.textContent = "Please enter a valid email address.";
            this.emailError.classList.add('show');
            valid = false;
        }
        if (this.password.value.length < 8) {
            this.passwordError.textContent = "Password must be at least 8 characters.";
            this.passwordError.classList.add('show');
            valid = false;
        }
        return valid;
      }

      async handleSubmit(e){
        e.preventDefault();
        if (!this.validate()) return;

        // Give user feedback that something is happening
        this.submitBtn.textContent = 'Authenticating...';
        this.submitBtn.disabled = true;

        const loginData = {
            email: this.email.value,
            password: this.password.value
        };

        try {
            // Send the data to the PHP backend script
            // The path '../backend/login.php' assumes this HTML file is in a 'Frontend' folder
            const response = await fetch('../backend/login.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(loginData)
            });

            const result = await response.json();

            // Check if the HTTP response status is OK (e.g., 200) AND the custom status in the JSON is 'success'
            if (response.ok && result.status === 'success') {
                this.modal.classList.add('show');
            } else {
                // Display the specific error message from the server
                this.passwordError.textContent = result.message || 'An unknown error occurred.';
                this.passwordError.classList.add('show');
            }

        } catch (error) {
            // This catches network errors or if the server crashes (e.g., fatal PHP error)
            console.error('Login Error:', error);
            this.passwordError.textContent = 'Cannot connect to the server. Please try again.';
            this.passwordError.classList.add('show');
        } finally {
            // This code runs whether the login succeeded or failed
            // Re-enable the button so the user can try again
            this.submitBtn.textContent = 'Sign In';
            this.submitBtn.disabled = false;
        }
      }
    }

    // Main entry point for the script
    document.addEventListener('DOMContentLoaded', () => {
      new ParticleSystem();
      new FormHandler();
      // Fade in the body for a smooth loading effect
      document.body.style.opacity='0';
      setTimeout(() => { document.body.style.opacity='1'; }, 100);
    });
  </script>
</body>
</html>